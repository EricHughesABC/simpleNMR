<!DOCTYPE html>
<html lang="en">
<head>

<style>
    .tooltip {
        position: absolute;
        background-color: #fff;
        border: 1px solid #ddd;
        padding: 8px;
        border-radius: 5px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        pointer-events: none;
        display: inline-block;
        max-width: 480px; /* Set max-width for the tooltip */
    }

    /* Style for the SVG border */
    svg {
        border: 1px solid black; /* 1px solid black border */
    }
    .center {
        display: block;
        margin-left: auto;
        margin-right: auto;
    }
    </style>

<style>
    .container {
        text-align: center;
    }
    .color-container {
        position: relative;
        display: inline-block;
        margin-right: 20px;
    }

    .color-box {
        width: 100px;
        height: 50px;
    }

    .striped-rectangle {
        width: 100px;
        height: 50px;
        background: repeating-linear-gradient(90deg, #ccc, #ccc 10px, #fff 10px, #fff 20px);
    }

    .color-text {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: black; /* Adjust text color as needed */
    }

    .orange { background-color: #FFA500; }
    .green { background-color: #98FB98; }
    .yellow { background-color: yellow; }
    .cyan { background-color: #00FFFF; }
    .grey { background-color: #808080; }
    .blue { background-color: #ADD8E6; }
</style>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rotenone</title>
  <script src="https://d3js.org/d3.v6.min.js"></script>
</head>
<body>

     <!-- SVG container with background molecule image -->

    <?xml version='1.0' encoding='iso-8859-1'?>
<svg class="center" version='1.1' baseProfile='full'
              xmlns='http://www.w3.org/2000/svg'
                      xmlns:rdkit='http://www.rdkit.org/xml'
                      xmlns:xlink='http://www.w3.org/1999/xlink'
                  xml:space='preserve'
width=1200 height=700 viewBox='0 0 1200 700'>
<!-- END OF HEADER -->
<g transform='translate(100, 50)'>
<rect style='opacity:1.0;fill:none;stroke:none' width='1000' height='600' x='0' y='0'> </rect>
<path class='bond-0' d='M 45.4545,296.167 L 116.018,342.547' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1' d='M 107.588,342.059 L 102.703,426.358' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1' d='M 124.448,343.036 L 119.563,427.335' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-2' d='M 116.018,342.547 L 191.466,304.628' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3' d='M 191.466,304.628 L 266.491,343.378' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-28' d='M 191.466,304.628 L 197.105,270.251' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-28' d='M 197.105,270.251 L 202.744,235.875' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-4' d='M 266.491,343.378 L 326.528,283.999' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-5' d='M 326.528,283.999 L 288.608,208.551' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-5' d='M 335.93,265.098 L 309.386,212.284' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-29' d='M 326.528,283.999 L 410.828,288.884' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-6' d='M 288.608,208.551 L 334.988,137.988' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-27' d='M 288.608,208.551 L 253.416,213.926' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-27' d='M 253.416,213.926 L 218.224,219.301' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-7' d='M 334.988,137.988 L 419.288,142.872' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-7' d='M 346.656,155.58 L 405.666,159' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-8' d='M 419.288,142.872 L 457.208,218.32' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-9' d='M 457.208,218.32 L 541.507,223.205' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-30' d='M 457.208,218.32 L 410.828,288.884' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-30' d='M 436.138,219.629 L 403.672,269.023' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10' d='M 548.564,227.843 L 566.964,199.848' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10' d='M 566.964,199.848 L 585.364,171.854' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10' d='M 534.451,218.567 L 552.851,190.572' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10' d='M 552.851,190.572 L 571.251,162.578' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-11' d='M 541.507,223.205 L 579.427,298.653' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-12' d='M 579.427,298.653 L 663.727,303.537' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-31' d='M 579.427,298.653 L 533.047,369.216' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-13' d='M 663.727,303.537 L 710.107,232.974' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-13' d='M 684.796,302.229 L 717.262,252.834' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-32' d='M 663.727,303.537 L 701.646,378.985' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-14' d='M 710.107,232.974 L 794.406,237.859' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-15' d='M 794.406,237.859 L 812.807,209.864' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-15' d='M 812.807,209.864 L 831.207,181.87' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-17' d='M 794.406,237.859 L 832.326,313.306' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-17' d='M 785.005,256.76 L 811.549,309.573' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-16' d='M 853.875,168.054 L 889.48,170.117' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-16' d='M 889.48,170.117 L 925.086,172.18' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-18' d='M 832.326,313.306 L 867.932,315.37' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-18' d='M 867.932,315.37 L 903.537,317.433' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-20' d='M 832.326,313.306 L 785.946,383.87' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-19' d='M 923.951,332.766 L 939.248,363.202' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-19' d='M 939.248,363.202 L 954.545,393.639' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-21' d='M 785.946,383.87 L 701.646,378.985' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-21' d='M 774.278,366.277 L 715.268,362.858' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-22' d='M 701.646,378.985 L 683.124,407.165' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-22' d='M 683.124,407.165 L 664.602,435.346' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-23' d='M 642.178,448.79 L 606.572,446.727' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-23' d='M 606.572,446.727 L 570.967,444.664' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-24' d='M 570.967,444.664 L 533.047,369.216' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-25' d='M 533.047,369.216 L 497.441,367.153' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-25' d='M 497.441,367.153 L 461.836,365.09' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-26' d='M 441.609,350.129 L 426.218,319.506' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-26' d='M 426.218,319.506 L 410.828,288.884' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path  class='atom-11' d='M 576.91 152.709
Q 576.91 146.967, 579.747 143.758
Q 582.584 140.55, 587.887 140.55
Q 593.19 140.55, 596.028 143.758
Q 598.865 146.967, 598.865 152.709
Q 598.865 158.519, 595.994 161.829
Q 593.123 165.105, 587.887 165.105
Q 582.618 165.105, 579.747 161.829
Q 576.91 158.552, 576.91 152.709
M 587.887 162.403
Q 591.535 162.403, 593.494 159.971
Q 595.487 157.505, 595.487 152.709
Q 595.487 148.014, 593.494 145.65
Q 591.535 143.252, 587.887 143.252
Q 584.24 143.252, 582.247 145.616
Q 580.288 147.98, 580.288 152.709
Q 580.288 157.539, 582.247 159.971
Q 584.24 162.403, 587.887 162.403
' fill='#FF0000'/>
<path  class='atom-16' d='M 829.809 167.363
Q 829.809 161.621, 832.646 158.412
Q 835.483 155.203, 840.786 155.203
Q 846.089 155.203, 848.927 158.412
Q 851.764 161.621, 851.764 167.363
Q 851.764 173.172, 848.893 176.482
Q 846.022 179.759, 840.786 179.759
Q 835.517 179.759, 832.646 176.482
Q 829.809 173.206, 829.809 167.363
M 840.786 177.057
Q 844.434 177.057, 846.393 174.625
Q 848.386 172.159, 848.386 167.363
Q 848.386 162.668, 846.393 160.303
Q 844.434 157.905, 840.786 157.905
Q 837.139 157.905, 835.146 160.27
Q 833.187 162.634, 833.187 167.363
Q 833.187 172.193, 835.146 174.625
Q 837.139 177.057, 840.786 177.057
' fill='#FF0000'/>
<path  class='atom-19' d='M 905.648 318.259
Q 905.648 312.517, 908.486 309.308
Q 911.323 306.099, 916.626 306.099
Q 921.929 306.099, 924.766 309.308
Q 927.603 312.517, 927.603 318.259
Q 927.603 324.068, 924.732 327.378
Q 921.861 330.654, 916.626 330.654
Q 911.357 330.654, 908.486 327.378
Q 905.648 324.102, 905.648 318.259
M 916.626 327.952
Q 920.274 327.952, 922.233 325.52
Q 924.225 323.055, 924.225 318.259
Q 924.225 313.564, 922.233 311.199
Q 920.274 308.801, 916.626 308.801
Q 912.978 308.801, 910.985 311.166
Q 909.026 313.53, 909.026 318.259
Q 909.026 323.089, 910.985 325.52
Q 912.978 327.952, 916.626 327.952
' fill='#FF0000'/>
<path  class='atom-23' d='M 644.289 449.616
Q 644.289 443.874, 647.126 440.665
Q 649.964 437.457, 655.266 437.457
Q 660.569 437.457, 663.407 440.665
Q 666.244 443.874, 666.244 449.616
Q 666.244 455.426, 663.373 458.736
Q 660.502 462.012, 655.266 462.012
Q 649.997 462.012, 647.126 458.736
Q 644.289 455.46, 644.289 449.616
M 655.266 459.31
Q 658.914 459.31, 660.873 456.878
Q 662.866 454.412, 662.866 449.616
Q 662.866 444.921, 660.873 442.557
Q 658.914 440.159, 655.266 440.159
Q 651.619 440.159, 649.626 442.523
Q 647.667 444.888, 647.667 449.616
Q 647.667 454.446, 649.626 456.878
Q 651.619 459.31, 655.266 459.31
' fill='#FF0000'/>
<path  class='atom-26' d='M 437.77 364.399
Q 437.77 358.657, 440.607 355.448
Q 443.445 352.24, 448.747 352.24
Q 454.05 352.24, 456.888 355.448
Q 459.725 358.657, 459.725 364.399
Q 459.725 370.209, 456.854 373.519
Q 453.983 376.795, 448.747 376.795
Q 443.478 376.795, 440.607 373.519
Q 437.77 370.243, 437.77 364.399
M 448.747 374.093
Q 452.395 374.093, 454.354 371.661
Q 456.347 369.195, 456.347 364.399
Q 456.347 359.704, 454.354 357.34
Q 452.395 354.942, 448.747 354.942
Q 445.1 354.942, 443.107 357.306
Q 441.148 359.67, 441.148 364.399
Q 441.148 369.229, 443.107 371.661
Q 445.1 374.093, 448.747 374.093
' fill='#FF0000'/>
<path  class='atom-28' d='M 194.158 221.368
Q 194.158 215.626, 196.995 212.417
Q 199.832 209.208, 205.135 209.208
Q 210.438 209.208, 213.275 212.417
Q 216.113 215.626, 216.113 221.368
Q 216.113 227.177, 213.242 230.487
Q 210.371 233.764, 205.135 233.764
Q 199.866 233.764, 196.995 230.487
Q 194.158 227.211, 194.158 221.368
M 205.135 231.062
Q 208.783 231.062, 210.742 228.63
Q 212.735 226.164, 212.735 221.368
Q 212.735 216.673, 210.742 214.309
Q 208.783 211.91, 205.135 211.91
Q 201.488 211.91, 199.495 214.275
Q 197.536 216.639, 197.536 221.368
Q 197.536 226.198, 199.495 228.63
Q 201.488 231.062, 205.135 231.062
' fill='#FF0000'/>
<path  d='M 45.4545,296.167 L 116.018,342.547' class='bond-selector bond-0' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 116.018,342.547 L 111.133,426.847' class='bond-selector bond-1' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 116.018,342.547 L 191.466,304.628' class='bond-selector bond-2' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 191.466,304.628 L 266.491,343.378' class='bond-selector bond-3' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 266.491,343.378 L 326.528,283.999' class='bond-selector bond-4' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 326.528,283.999 L 288.608,208.551' class='bond-selector bond-5' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 288.608,208.551 L 334.988,137.988' class='bond-selector bond-6' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 334.988,137.988 L 419.288,142.872' class='bond-selector bond-7' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 419.288,142.872 L 457.208,218.32' class='bond-selector bond-8' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 457.208,218.32 L 541.507,223.205' class='bond-selector bond-9' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 541.507,223.205 L 587.887,152.641' class='bond-selector bond-10' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 541.507,223.205 L 579.427,298.653' class='bond-selector bond-11' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 579.427,298.653 L 663.727,303.537' class='bond-selector bond-12' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 663.727,303.537 L 710.107,232.974' class='bond-selector bond-13' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 710.107,232.974 L 794.406,237.859' class='bond-selector bond-14' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 794.406,237.859 L 840.786,167.295' class='bond-selector bond-15' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 840.786,167.295 L 925.086,172.18' class='bond-selector bond-16' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 794.406,237.859 L 832.326,313.306' class='bond-selector bond-17' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 832.326,313.306 L 916.626,318.191' class='bond-selector bond-18' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 916.626,318.191 L 954.545,393.639' class='bond-selector bond-19' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 832.326,313.306 L 785.946,383.87' class='bond-selector bond-20' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 785.946,383.87 L 701.646,378.985' class='bond-selector bond-21' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 701.646,378.985 L 655.266,449.549' class='bond-selector bond-22' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 655.266,449.549 L 570.967,444.664' class='bond-selector bond-23' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 570.967,444.664 L 533.047,369.216' class='bond-selector bond-24' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 533.047,369.216 L 448.747,364.332' class='bond-selector bond-25' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 448.747,364.332 L 410.828,288.884' class='bond-selector bond-26' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 288.608,208.551 L 205.135,221.3' class='bond-selector bond-27' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 205.135,221.3 L 191.466,304.628' class='bond-selector bond-28' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 410.828,288.884 L 326.528,283.999' class='bond-selector bond-29' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 410.828,288.884 L 457.208,218.32' class='bond-selector bond-30' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 533.047,369.216 L 579.427,298.653' class='bond-selector bond-31' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 701.646,378.985 L 663.727,303.537' class='bond-selector bond-32' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='45.4545' cy='296.167' r='11.2588' class='atom-selector atom-0' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='116.018' cy='342.547' r='11.2588' class='atom-selector atom-1' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='111.133' cy='426.847' r='11.2588' class='atom-selector atom-2' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='191.466' cy='304.628' r='11.2588' class='atom-selector atom-3' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='266.491' cy='343.378' r='11.2588' class='atom-selector atom-4' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='326.528' cy='283.999' r='11.2588' class='atom-selector atom-5' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='288.608' cy='208.551' r='11.2588' class='atom-selector atom-6' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='334.988' cy='137.988' r='11.2588' class='atom-selector atom-7' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='419.288' cy='142.872' r='11.2588' class='atom-selector atom-8' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='457.208' cy='218.32' r='11.2588' class='atom-selector atom-9' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='541.507' cy='223.205' r='11.2588' class='atom-selector atom-10' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='587.887' cy='152.641' r='11.2588' class='atom-selector atom-11' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='579.427' cy='298.653' r='11.2588' class='atom-selector atom-12' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='663.727' cy='303.537' r='11.2588' class='atom-selector atom-13' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='710.107' cy='232.974' r='11.2588' class='atom-selector atom-14' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='794.406' cy='237.859' r='11.2588' class='atom-selector atom-15' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='840.786' cy='167.295' r='11.2588' class='atom-selector atom-16' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='925.086' cy='172.18' r='11.2588' class='atom-selector atom-17' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='832.326' cy='313.306' r='11.2588' class='atom-selector atom-18' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='916.626' cy='318.191' r='11.2588' class='atom-selector atom-19' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='954.545' cy='393.639' r='11.2588' class='atom-selector atom-20' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='785.946' cy='383.87' r='11.2588' class='atom-selector atom-21' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='701.646' cy='378.985' r='11.2588' class='atom-selector atom-22' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='655.266' cy='449.549' r='11.2588' class='atom-selector atom-23' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='570.967' cy='444.664' r='11.2588' class='atom-selector atom-24' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='533.047' cy='369.216' r='11.2588' class='atom-selector atom-25' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='448.747' cy='364.332' r='11.2588' class='atom-selector atom-26' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='410.828' cy='288.884' r='11.2588' class='atom-selector atom-27' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='205.135' cy='221.3' r='11.2588' class='atom-selector atom-28' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
</g>
</svg>
 

    <!-- Tooltip for displaying node information -->
    <div id="tooltip" class="tooltip">Tooltip content</div>
    <br>
    <div class="container">
        <div class="color-container">
            <div class="color-box orange"></div>
            <div class="color-text">-C-</div>
        </div>
        <div class="color-container">
            <div class="color-box green"></div>
            <div class="color-text">-CH</div>
        </div>
        <div class="color-container">
            <div class="color-box yellow"></div>
            <div class="color-text">-CH<sub>2</sub></div>
        </div>
        <div class="color-container">
            <div class="color-box cyan"></div>
            <div class="color-text">-CH<sub>3</sub></div>
        </div>
        <div class="color-container">
            <div class="color-box grey"></div>
            <div class="color-text">HMBC</div>
        </div>
        <div class="color-container">
            <div class="color-box blue"></div>
            <div class="color-text">COSY</div>
        </div>
        <div class="color-container">
            <div class="striped-rectangle"></div>
            <div class="color-text">NOESY</div>
        </div>
    </div>
        
  <script>
    // Create the SVG container
    const svg = d3.select("svg");
    const width = +svg.attr("width");
    const height = +svg.attr("height");

    // Get the corresponding DOM element
    var svgNode = svg.node();
    // Get the dimensions of the SVG element
    var svgWidth = svgNode.clientWidth;
    var svgHeight = svgNode.clientHeight;

    // Define scale functions for x and y coordinates
    const xScale = d3.scaleLinear().domain([0, 1]).range([0, width-100*2]);
    const yScale = d3.scaleLinear().domain([0, 1]).range([0, height-50*2]);

    // // define colour blind friendly colours
    // const orange = '#FFA500';
    // const blue = '#ADD8E6';
    // const green = '#98FB98';
    // const yellow = '#FFFF00';
    // const purple = '#800080';
    // const cyan = '#00FFFF';
    // const grey = '#808080';
    // const black = '#000000';
    // const white = '#FFFFFF';

    // define colour blind friendly colours with 50% transparency
    const orange = 'rgba(255, 165, 0, 1)';
    const blue = 'rgba(173, 216, 230, 1)';
    const green = 'rgba(152, 251, 152, 1)';
    const yellow = 'rgba(255, 255, 0, 1)';
    const purple = 'rgba(128, 0, 128, 1)';
    const cyan = 'rgba(0, 255, 255, 1)';
    const grey = 'rgba(128, 128, 128, 1)';

    const black = 'rgba(0, 0, 0, 1)';
    const white = 'rgba(255, 255, 255, 1)';

    // Define color scale for nodes based on numProtons
    const colorScale = d3.scaleOrdinal()
      .domain([0, 1, 2, 3])
      .range([orange, green, yellow, cyan ]); // Blue, Orange, Green, Red

    // Define the graph data
    const nodes = [	{numProtons: 0, ppm: 188.8980677329613, x: 0.5415074182499037, y: 0.3720081222842836, H1_ppm: [], jCouplingClass: [], jCouplingVals: [], id: 1},
	{numProtons: 0, ppm: 167.3310154349626, x: 0.28860842372512713, y: 0.3475853747660251, H1_ppm: [], jCouplingClass: [], jCouplingVals: [], id: 2},
	{numProtons: 0, ppm: 157.9027177688779, x: 0.4108277770313103, y: 0.48147283399737556, H1_ppm: [], jCouplingClass: [], jCouplingVals: [], id: 3},
	{numProtons: 0, ppm: 149.4661944828916, x: 0.8323261012392712, y: 0.5221774131944733, H1_ppm: [], jCouplingClass: [], jCouplingVals: [], id: 4},
	{numProtons: 0, ppm: 147.3425788177382, x: 0.701646460020678, y: 0.6316421249075652, H1_ppm: [], jCouplingClass: [], jCouplingVals: [], id: 5},
	{numProtons: 0, ppm: 143.856112607584, x: 0.7944064127746804, y: 0.39643086980254244, H1_ppm: [], jCouplingClass: [], jCouplingVals: [], id: 6},
	{numProtons: 0, ppm: 143.0011654238308, x: 0.11601792198605235, y: 0.5709121280048809, H1_ppm: [], jCouplingClass: [], jCouplingVals: [], id: 7},
	{numProtons: 1, ppm: 129.9509245611761, x: 0.41928806494372045, y: 0.23812066305293306, H1_ppm: [7.826572765764225], jCouplingClass: ["m"], jCouplingVals: ["0"], id: 8},
	{numProtons: 0, ppm: 113.307178276358, x: 0.45720775340831155, y: 0.363867206444864, H1_ppm: [], jCouplingClass: [], jCouplingVals: [], id: 9},
	{numProtons: 0, ppm: 112.93201300483, x: 0.3265281121897182, y: 0.4733319181579559, H1_ppm: [], jCouplingClass: [], jCouplingVals: [], id: 10},
	{numProtons: 2, ppm: 112.5273814211102, x: 0.11113337248240071, y: 0.7114115694075345, H1_ppm: [5.059401833226492, 4.918821859341227], jCouplingClass: ["dd", "d"], jCouplingVals: ["0.88, 1.61", "1.32"], id: 11},
	{numProtons: 1, ppm: 110.3530999558873, x: 0.7101067479330881, y: 0.3882899539631228, H1_ppm: [6.758826438839741], jCouplingClass: ["d"], jCouplingVals: ["1.15"], id: 12},
	{numProtons: 1, ppm: 104.8596960522052, x: 0.7859461248622699, y: 0.6397830407469848, H1_ppm: [6.492281393557239], jCouplingClass: ["d"], jCouplingVals: ["8.58"], id: 13},
	{numProtons: 0, ppm: 104.7932567180195, x: 0.6637267715560868, y: 0.5058955815156344, H1_ppm: [], jCouplingClass: [], jCouplingVals: [], id: 14},
	{numProtons: 1, ppm: 100.8841991947001, x: 0.33498840010212827, y: 0.2299797472135136, H1_ppm: [6.437177947373455], jCouplingClass: ["s"], jCouplingVals: ["0"], id: 15},
	{numProtons: 1, ppm: 87.8109929368774, x: 0.19146584802121083, y: 0.5077126472305625, H1_ppm: [5.222878086136681], jCouplingClass: ["t"], jCouplingVals: ["8.96"], id: 16},
	{numProtons: 1, ppm: 72.19761158990195, x: 0.5330471303374935, y: 0.615360293228726, H1_ppm: [4.910357601864534], jCouplingClass: ["m"], jCouplingVals: ["0"], id: 17},
	{numProtons: 2, ppm: 66.25035969080703, x: 0.5709668188020846, y: 0.741106836620657, H1_ppm: [4.593347908241471, 4.165622890698084], jCouplingClass: ["dd", "dt"], jCouplingVals: ["3.12, 12.1", "1.05, 12.1"], id: 18},
	{numProtons: 3, ppm: 56.29920567012644, x: 0.9250860539932737, y: 0.2869661580894508, H1_ppm: [3.750768231951263], jCouplingClass: ["s"], jCouplingVals: ["0"], id: 19},
	{numProtons: 3, ppm: 55.8279942406795, x: 0.9545454545454545, y: 0.6560648724258239, H1_ppm: [3.793860953087835], jCouplingClass: ["s"], jCouplingVals: ["0"], id: 20},
	{numProtons: 1, ppm: 44.58250202194321, x: 0.5794271067144948, y: 0.49775466567621457, H1_ppm: [3.826909618920722], jCouplingClass: ["dt"], jCouplingVals: ["0.956, 4.07"], id: 21},
	{numProtons: 2, ppm: 31.25673565118749, x: 0.26649069864998826, y: 0.5722960150668551, H1_ppm: [3.304558139303091, 2.941435898864545], jCouplingClass: ["dd", "dd"], jCouplingVals: ["9.8, 15.8", "8.2, 15.7"], id: 22},
	{numProtons: 3, ppm: 17.11178683397549, x: 0.04545454545454549, y: 0.4936121673765458, H1_ppm: [1.754274215835146], jCouplingClass: ["t"], jCouplingVals: ["1.17"], id: 23},
];

    const links = [	{"hmbc": true, "source": 1, "target": 8},
	{"hmbc": true, "source": 2, "target": 22},
	{"hmbc": true, "source": 3, "target": 22},
	{"hmbc": true, "source": 4, "target": 20},
	{"hmbc": true, "source": 5, "target": 18},
	{"hmbc": true, "source": 6, "target": 19},
	{"hmbc": true, "source": 7, "target": 22},
	{"hmbc": true, "source": 7, "target": 23},
	{"cosy": true, "source": 8, "target": 13},
	{"hmbc": true, "source": 8, "target": 22},
	{"hmbc": true, "source": 9, "target": 13},
	{"hmbc": true, "source": 9, "target": 22},
	{"hmbc": true, "source": 10, "target": 22},
	{"hmbc": true, "source": 11, "target": 23},
	{"hmbc": true, "source": 13, "target": 22},
	{"hmbc": true, "source": 14, "target": 15},
	{"hmbc": true, "source": 16, "target": 23},
	{"hmbc": true, "source": 16, "target": 22},
	{"cosy": true, "source": 17, "target": 21},
];

    // Set initial positions of nodes and links
    nodes.forEach(node => {
        node.x = xScale(node.x)+100;
        node.y = yScale(node.y)+50;
    });

    // Filter links that have the attribute cosy as true
    const cosyLinks = links.filter(link => link.cosy);

    // Create the links
    const link = svg.selectAll(".link")
      .data(cosyLinks)
      .enter().append("line")
      .attr("class", "link")
      .attr("stroke", "black")
      .attr("x1", d => nodes[d.source-1].x)
      .attr("y1", d => nodes[d.source-1].y)
      .attr("x2", d => nodes[d.target-1].x)
      .attr("y2", d => nodes[d.target-1].y)
      .attr("stroke", blue) // Set the stroke color for links to blue
      .attr("stroke-width", 8); // Set the stroke width to 2 pixels

    // Create the nodes
    const node = svg.selectAll(".node")
      .data(nodes)
      .enter().append("g")
      .attr("class", "node")
      .attr("transform", d => `translate(${d.x},${d.y})`)
      .call(d3.drag()
        .on("start", dragstarted)
        .on("drag", dragged)
        .on("end", dragended));

    // Add circles to represent nodes
    node.append("circle")
      .attr("r", 22)
      .attr("fill", d => colorScale(d.numProtons)) // Set fill color based on numProtons
      .on("mouseover", (event, d) => handleMouseOver(event, d)) // Call function when mouseover
      .on("mouseout", (event, d) => handleMouseOut(event, d));  // Call function when mouseout

    // Append text
    node.append("text")
        .attr("class", "node-text")
        .text(d => d.id) // Display the id
        .attr("dy", -8) // Center the text vertically
        .attr("font-size", "12px") // Set font size to 16 pixels
        .attr("text-anchor", "middle"); // Center the text horizontally

    // // Append ppm text
    node.append("text")
        .attr("class", "node-text")
        .text(d => d.ppm.toFixed(2)) // Display the id
        .attr("dy", +8) // Center the text vertically
        .attr("font-size", "12px") // Set font size to 16 pixels
        .attr("text-anchor", "middle"); // Center the text horizontally

    // Tooltip for node hover
    const tooltip = d3.select("#tooltip");

    let hmbcLinks = []; // Track hmbc links separately
    var circlenodes = document.querySelectorAll('.node circle');
    var textnodes = document.querySelectorAll('.node text');
    console.log("length of textnodes: ", textnodes.length);
    console.log(textnodes[0])

    // Drag handlers
    function dragstarted(event, d) {
      // Remove hmbc links
      hmbcLinks.forEach(link => link.remove());
      hmbcLinks = []; // Clear the hmbc links array
      d3.select(this).raise().classed("active", true);
    }

    function dragged(event, d) {
      d.x = event.x;
      d.y = event.y;
      d3.select(this).attr("transform", `translate(${d.x},${d.y})`);
      link.filter(l => l.source === d.id).attr("x1", d.x).attr("y1", d.y);
      link.filter(l => l.target === d.id).attr("x2", d.x).attr("y2", d.y);
    }

    function dragended(event, d) {
      d3.select(this).classed("active", false);
    }

    // // Function to find nearest neighbors of a node with a specific attribute
    // function findNearestNeighbors(nodeId, attribute) {
    // const neighbors = [];

    // // Iterate through the links
    // links.forEach(link => {
    //     if (link[attribute] && (link.source === nodeId || link.target === nodeId)) {
    //     neighbors.push(link.source === nodeId ? link.target : link.source);
    //     }
    // });

    // return neighbors;
    // }

    // Function to find nearest neighbors of a node with a specific attribute
    function findNearestNeighbors(nodeId, attribute) {
        const neighbors = [];
        const nonNeighbors = [];

        // Iterate through the links
        links.forEach(link => {
            if (link[attribute] && (link.source === nodeId || link.target === nodeId)) {
                neighbors.push(link.source === nodeId ? link.target : link.source);
            }
        });

        // Iterate through all nodes to find non-neighbors
        nodes.forEach(node => {
            if (node.id !== nodeId && !neighbors.includes(node.id)) {
                nonNeighbors.push(node.id);
            }
        });

        return { neighbors, nonNeighbors };
    }

    // Function to handle mouseover event
    function handleMouseOver(event, d) {
        // Display tooltip
        if (event) {

            // generate the html sub string for d.H1 ppm which is an array

            // When numProtons is 0
            if (d.numProtons == 0) {
                var htmlstr =  `C${d.id} ${generateHTMLnumProtonsString(d.numProtons)}: <sup>13</sup>C = ${d.ppm.toFixed(2)} ppm`;
            } else if (d.H1_ppm.length == 1) {
                // Expect d.H1 to be an array of length 1
                var htmlstr =  `C${d.id} ${generateHTMLnumProtonsString(d.numProtons)}: <sup>13</sup>C = ${d.ppm.toFixed(2)} ppm, <sup>1</sup>H = ${d.H1_ppm[0].toFixed(2)} ppm`;
                    htmlstr = htmlstr + `<br>J's : ${d.jCouplingClass[0]} : ${d.jCouplingVals[0]} Hz`;
            } else {
                // Expect d.H1 to be an array of length 2
                var htmlstr =  `C${d.id} ${generateHTMLnumProtonsString(d.numProtons)}: <sup>13</sup>C = ${d.ppm.toFixed(2)} ppm, <sup>1</sup>H = ${d.H1_ppm[0].toFixed(2)} & ${d.H1_ppm[1].toFixed(2)} ppm`;
                // add the J coupling values
                htmlstr = htmlstr + `<br>J's : ${d.jCouplingClass[0]} : ${d.jCouplingVals[0]} Hz, ${d.jCouplingClass[1]} : ${d.jCouplingVals[1]} Hz`;
            }

            // var htmlstr =  `C${d.id} ${generateHTMLnumProtonsString(d.numProtons)}: <sup>13</sup>C = ${d.ppm.toFixed(2)} ppm, <sup>1</sup>H = xxx ppm`;
            tooltip.transition()
                .duration(200)
                .style("opacity", 0.9);
            tooltip.html(htmlstr)    
                .style("left", (200) + "px")
                .style("top", (-99999) + "px")
                .style("display", "inline-block");

            var tooltipDiv = d3.select('#tooltip');

            // Get the corresponding DOM element
            var tooltipNode = tooltipDiv.node();

            var pageWidth = document.documentElement.clientWidth;

            // Get the dimensions of the div element
            var tooltipWidth = tooltipNode.clientWidth;
            var tooltipHeight = tooltipNode.clientHeight;
            var tooltipX = (pageWidth - tooltipWidth) / 2;

            tooltip.html(htmlstr) 
                .style("left", (tooltipX) + "px")
                .style("top", (30) + "px")
                .style("display", "inline-block");
        }
        // Increase the radius
        d3.select(event.target)
            .transition()
            .duration(100)
            .attr("r", 26);

        // select all the nodes circles
        // var circlenodes = document.querySelectorAll('.node circle');

        // Define the attribute to find nearest neighbors
        const attribute = "hmbc";
        const attribute2 = "noesy";
        
        // Call the function to find nearest neighbors
        const hmbcNearestNodes = findNearestNeighbors(d.id, attribute);
        const noesyNearestNodes = findNearestNeighbors(d.id, attribute2);

        const nearestNeighborIDs = hmbcNearestNodes.neighbors;
        const nearestNeighborIDs2 = noesyNearestNodes.neighbors;
    
        // change the fill color of non-neighbors to grey
        hmbcNearestNodes.nonNeighbors.forEach(nonNeighborId => {
            circlenodes[nonNeighborId-1].style.fill = 'lightgrey';
        });
        // set the font colour to grey for all the text nodes
        hmbcNearestNodes.nonNeighbors.forEach(i => {
            var ii = (i-1)*2;
            textnodes[ii].style.fill = 'lightgrey';
            textnodes[ii+1].style.fill = 'lightgrey';
        });

        // set the text opacity to 0 for all the non-neighbors
        hmbcNearestNodes.nonNeighbors.forEach(nonNeighborId => {
            textnodes[nonNeighborId-1].style.opacity = 0;
            textnodes[nonNeighborId].style.opacity = 0;
        });


        // decrease the size of the circles for the non-neighbors to 10
        hmbcNearestNodes.nonNeighbors.forEach(nonNeighborId => {
            circlenodes[nonNeighborId-1].setAttribute("r", 10);
        });

        // increase the size of the circles for the nearest neighbors
        nearestNeighborIDs.forEach(neighborID => {
            circlenodes[neighborID-1].setAttribute("r", 26);
        });

        // Add hmbc links to nearest neighbors
        nearestNeighborIDs.forEach(neighborID => {
            const neighborNode = nodes.find(node => node.id === neighborID);
            if (neighborNode) {
                const link = svg.insert("line", ".node")
                    .attr("class", "link")
                    .attr("x1", d.x)
                    .attr("y1", d.y)
                    .attr("x2", neighborNode.x)
                    .attr("y2", neighborNode.y)
                    .attr("stroke", grey)
                    .attr("stroke-width", 7); // Set the stroke width to 2 pixels
                hmbcLinks.push(link); // Track the hmbc links
            }
        });

    nearestNeighborIDs2.forEach(neighborID => {
        const neighborNode = nodes.find(node => node.id === neighborID);
            if (neighborNode) {
                // Calculate control points for the curve
                // const control1X = d.x + (neighborNode.x - d.x) / 3;
                // const control1Y = d.y;
                // const control2X = neighborNode.x - (neighborNode.x - d.x) / 3;
                // const control2Y = neighborNode.y;

                const path = d3.path();
                path.moveTo(d.x, d.y);
                path.quadraticCurveTo(0, 0, neighborNode.x, neighborNode.y);

                const link = svg.insert("path", ".node")
                    .attr("class", "link")
                    .attr("fill", "none")
                    .attr("stroke", grey)
                    .attr("stroke-width", 7) // Set the stroke width to 7 pixels
                    .attr("stroke-dasharray", "5,5") // Set the stroke-dasharray for dashed lines
                    .attr("d", path); // Generate the curved link path using cubic Bezier curve
                hmbcLinks.push(link); // Track the hmbc links
            }
    });
}

    // Function to handle mouseout event
    function handleMouseOut(event, d) {
        // set the opacity of all the circles to 1
        // var circlenodes = document.querySelectorAll('.node circle');

        // change the opacity of the text nodes to 1
        textnodes.forEach( t => {
            t.style.opacity = 1;
        });
        
        // reset the font colour of the text in the nodes to black
        textnodes.forEach( t => {
            t.style.fill = 'black';
        });

        // reset the fill color of all the circles to their original color
        // loop through the nodes to get the id and numProtons
        nodes.forEach(d => {
            circlenodes[d.id-1].style.fill = colorScale(d.numProtons);
            // reset the size of the circles
            circlenodes[d.id-1].setAttribute("r", 22);
        }
        );

        // Hide the tooltip
        tooltip.transition()
                .duration(100)
                .style("opacity", 0);
        // Revert the radius
        d3.select(event.target)
            .transition()
            .duration(100)
            .attr("r", 22);

        // Remove hmbc links
        hmbcLinks.forEach(link => link.remove());
        hmbcLinks = []; // Clear the hmbc links array
    }

    function generateHTMLnumProtonsString(index) {
        switch (index) {
            case 0:
            return "-C-";
            case 1:
            return "-CH";
            case 2:
            return "-CH<sub>2</sub>";
            case 3:
            return "-CH<sub>3</sub>";
            default:
            return "<p>Invalid index</p>";
        }
    }
  </script>
</body>
</html>