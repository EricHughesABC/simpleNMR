<!DOCTYPE html>
<html lang="en">
<head>

<style>
    .tooltip {
        position: absolute;
        background-color: #fff;
        border: 1px solid #ddd;
        padding: 8px;
        border-radius: 5px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        pointer-events: none;
        display: inline-block;
        max-width: 480px; /* Set max-width for the tooltip */
    }

    /* Style for the SVG border */
    svg {
        border: 1px solid black; /* 1px solid black border */
    }
    .center {
        display: block;
        margin-left: auto;
        margin-right: auto;
    }
    </style>

<style>
    .container {
        text-align: center;
    }
    .color-container {
        position: relative;
        display: inline-block;
        margin-right: 20px;
    }

    .color-box {
        width: 100px;
        height: 50px;
    }

    .striped-rectangle {
        width: 100px;
        height: 50px;
        background: repeating-linear-gradient(90deg, #ccc, #ccc 10px, #fff 10px, #fff 20px);
    }

    .color-text {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: black; /* Adjust text color as needed */
    }

    .orange { background-color: #FFA500; }
    .green { background-color: #98FB98; }
    .yellow { background-color: yellow; }
    .cyan { background-color: #00FFFF; }
    .grey { background-color: #808080; }
    .blue { background-color: #ADD8E6; }
</style>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>menthol_eeh</title>
  <script src="https://d3js.org/d3.v6.min.js"></script>
</head>
<body>

     <!-- SVG container with background molecule image -->

    <?xml version='1.0' encoding='iso-8859-1'?>
<svg class="center" version='1.1' baseProfile='full'
              xmlns='http://www.w3.org/2000/svg'
                      xmlns:rdkit='http://www.rdkit.org/xml'
                      xmlns:xlink='http://www.w3.org/1999/xlink'
                  xml:space='preserve'
width=1200 height=700 viewBox='0 0 1200 700'>
<!-- END OF HEADER -->
<g transform='translate(100, 50)'>
<rect style='opacity:1.0;fill:none;stroke:none' width='1000' height='600' x='0' y='0'> </rect>
<path class='bond-0' d='M 932.193,572.727 L 842.575,395.248' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1' d='M 842.575,395.248 L 951.468,228.897' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-2' d='M 842.575,395.248 L 644.064,384.12' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3' d='M 644.064,384.12 L 535.172,550.471' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10' d='M 644.064,384.12 L 554.446,206.64' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-4' d='M 535.172,550.471 L 336.661,539.343' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-5' d='M 336.661,539.343 L 247.043,361.863' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-6' d='M 247.043,361.863 L 48.5322,350.735' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-7' d='M 247.043,361.863 L 355.936,195.512' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-8' d='M 355.936,195.512 L 554.446,206.64' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-9' d='M 554.446,206.64 L 602.435,133.33' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-9' d='M 602.435,133.33 L 650.424,60.0194' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path  class='atom-10' d='M 650.339 40.3689
Q 650.339 33.5689, 653.699 29.7689
Q 657.059 25.9689, 663.339 25.9689
Q 669.619 25.9689, 672.979 29.7689
Q 676.339 33.5689, 676.339 40.3689
Q 676.339 47.2489, 672.939 51.1689
Q 669.539 55.0489, 663.339 55.0489
Q 657.099 55.0489, 653.699 51.1689
Q 650.339 47.2889, 650.339 40.3689
M 663.339 51.8489
Q 667.659 51.8489, 669.979 48.9689
Q 672.339 46.0489, 672.339 40.3689
Q 672.339 34.8089, 669.979 32.0089
Q 667.659 29.1689, 663.339 29.1689
Q 659.019 29.1689, 656.659 31.9689
Q 654.339 34.7689, 654.339 40.3689
Q 654.339 46.0889, 656.659 48.9689
Q 659.019 51.8489, 663.339 51.8489
' fill='#FF0000'/>
<path  class='atom-10' d='M 679.739 26.2889
L 683.579 26.2889
L 683.579 38.3289
L 698.059 38.3289
L 698.059 26.2889
L 701.899 26.2889
L 701.899 54.6089
L 698.059 54.6089
L 698.059 41.5289
L 683.579 41.5289
L 683.579 54.6089
L 679.739 54.6089
L 679.739 26.2889
' fill='#FF0000'/>
<path  d='M 932.193,572.727 L 842.575,395.248' class='bond-selector bond-0' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 842.575,395.248 L 951.468,228.897' class='bond-selector bond-1' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 842.575,395.248 L 644.064,384.12' class='bond-selector bond-2' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 644.064,384.12 L 535.172,550.471' class='bond-selector bond-3' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 535.172,550.471 L 336.661,539.343' class='bond-selector bond-4' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 336.661,539.343 L 247.043,361.863' class='bond-selector bond-5' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 247.043,361.863 L 48.5322,350.735' class='bond-selector bond-6' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 247.043,361.863 L 355.936,195.512' class='bond-selector bond-7' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 355.936,195.512 L 554.446,206.64' class='bond-selector bond-8' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 554.446,206.64 L 663.339,40.2889' class='bond-selector bond-9' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<path  d='M 554.446,206.64 L 644.064,384.12' class='bond-selector bond-10' style='fill:#fff;stroke:#fff;stroke-width:4px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='932.193' cy='572.727' r='26.5097' class='atom-selector atom-0' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='842.575' cy='395.248' r='26.5097' class='atom-selector atom-1' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='951.468' cy='228.897' r='26.5097' class='atom-selector atom-2' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='644.064' cy='384.12' r='26.5097' class='atom-selector atom-3' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='535.172' cy='550.471' r='26.5097' class='atom-selector atom-4' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='336.661' cy='539.343' r='26.5097' class='atom-selector atom-5' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='247.043' cy='361.863' r='26.5097' class='atom-selector atom-6' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='48.5322' cy='350.735' r='26.5097' class='atom-selector atom-7' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='355.936' cy='195.512' r='26.5097' class='atom-selector atom-8' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='554.446' cy='206.64' r='26.5097' class='atom-selector atom-9' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
<circle  cx='663.339' cy='40.2889' r='26.5097' class='atom-selector atom-10' style='fill:#fff;stroke:#fff;stroke-width:1px;fill-opacity:0;stroke-opacity:0' />
</g>
</svg>
 

    <!-- Tooltip for displaying node information -->
    <div id="tooltip" class="tooltip">Tooltip content</div>
    <br>
    <div class="container">
        <div class="color-container">
            <div class="color-box orange"></div>
            <div class="color-text">-C-</div>
        </div>
        <div class="color-container">
            <div class="color-box green"></div>
            <div class="color-text">-CH</div>
        </div>
        <div class="color-container">
            <div class="color-box yellow"></div>
            <div class="color-text">-CH<sub>2</sub></div>
        </div>
        <div class="color-container">
            <div class="color-box cyan"></div>
            <div class="color-text">-CH<sub>3</sub></div>
        </div>
        <div class="color-container">
            <div class="color-box grey"></div>
            <div class="color-text">HMBC</div>
        </div>
        <div class="color-container">
            <div class="color-box blue"></div>
            <div class="color-text">COSY</div>
        </div>
        <div class="color-container">
            <div class="striped-rectangle"></div>
            <div class="color-text">NOESY</div>
        </div>
    </div>
        
  <script>
    // Create the SVG container
    const svg = d3.select("svg");
    const width = +svg.attr("width");
    const height = +svg.attr("height");

    // Get the corresponding DOM element
    var svgNode = svg.node();
    // Get the dimensions of the SVG element
    var svgWidth = svgNode.clientWidth;
    var svgHeight = svgNode.clientHeight;

    // Define scale functions for x and y coordinates
    const xScale = d3.scaleLinear().domain([0, 1]).range([0, width-100*2]);
    const yScale = d3.scaleLinear().domain([0, 1]).range([0, height-50*2]);

    // // define colour blind friendly colours
    // const orange = '#FFA500';
    // const blue = '#ADD8E6';
    // const green = '#98FB98';
    // const yellow = '#FFFF00';
    // const purple = '#800080';
    // const cyan = '#00FFFF';
    // const grey = '#808080';
    // const black = '#000000';
    // const white = '#FFFFFF';

    // define colour blind friendly colours with 50% transparency
    const orange = 'rgba(255, 165, 0, 1)';
    const blue = 'rgba(173, 216, 230, 1)';
    const green = 'rgba(152, 251, 152, 1)';
    const yellow = 'rgba(255, 255, 0, 1)';
    const purple = 'rgba(128, 0, 128, 1)';
    const cyan = 'rgba(0, 255, 255, 1)';
    const grey = 'rgba(128, 128, 128, 1)';
    const black = 'rgba(0, 0, 0, 1)';
    const white = 'rgba(255, 255, 255, 1)';

    // Define color scale for nodes based on numProtons
    const colorScale = d3.scaleOrdinal()
      .domain([0, 1, 2, 3])
      .range([orange, green, yellow, cyan ]); // Blue, Orange, Green, Red

    // Define the graph data
    const nodes = [	{numProtons: 1, ppm: 71.45624523968847, x: 0.5544463604888693, y: 0.3444001244372335, H1_ppm: [3.37316353407825], jCouplingClass: ["u"], jCouplingVals: ["-1"], id: 1},
	{numProtons: 1, ppm: 50.08594939041541, x: 0.6440643826491709, y: 0.6401992456990139, H1_ppm: [1.082579927813231], jCouplingClass: ["u"], jCouplingVals: ["-1"], id: 2},
	{numProtons: 2, ppm: 45.02368012546037, x: 0.35593561735082935, y: 0.32585303685257305, H1_ppm: [1.935622811178832, 0.9233616515389534], jCouplingClass: ["u", "u"], jCouplingVals: ["-1", "-1"], id: 3},
	{numProtons: 2, ppm: 34.52508229025805, x: 0.3366609185333922, y: 0.8989041917914733, H1_ppm: [1.631697412837238, 0.8134251317922346], jCouplingClass: ["u", "u"], jCouplingVals: ["-1", "-1"], id: 4},
	{numProtons: 1, ppm: 31.61988835248829, x: 0.2470428963730908, y: 0.603105070529693, H1_ppm: [1.392058237618919], jCouplingClass: ["u"], jCouplingVals: ["-1"], id: 5},
	{numProtons: 3, ppm: 25.75770765006214, x: 0.8425751257872107, y: 0.6587463332836742, H1_ppm: [2.152557148062575], jCouplingClass: ["u"], jCouplingVals: ["-1"], id: 6},
	{numProtons: 2, ppm: 23.09613182394426, x: 0.5351716616714322, y: 0.9174512793761338, H1_ppm: [1.581417694453219, 0.9426115527338552], jCouplingClass: ["u", "u"], jCouplingVals: ["-1", "-1"], id: 7},
	{numProtons: 3, ppm: 22.18687997415696, x: 0.0485321532350508, y: 0.5845579829450325, H1_ppm: [0.885376237731424], jCouplingClass: ["u"], jCouplingVals: ["-1"], id: 8},
	{numProtons: 3, ppm: 20.98989019722177, x: 0.9514678467649493, y: 0.38149429960655434, H1_ppm: [0.8998574620091482], jCouplingClass: ["u"], jCouplingVals: ["-1"], id: 9},
	{numProtons: 1, ppm: 16.04175697670206, x: 0.9321931479475122, y: 0.9545454545454546, H1_ppm: [0.7802194202833508], jCouplingClass: ["u"], jCouplingVals: ["-1"], id: 10},
];

    const links = [	{"cosy": true, "source": 1, "target": 3},
	{"cosy": true, "source": 1, "target": 2},
	{"cosy": true, "hmbc": true, "source": 2, "target": 6},
	{"cosy": true, "source": 2, "target": 7},
	{"hmbc": true, "source": 2, "target": 10},
	{"cosy": true, "source": 3, "target": 5},
	{"cosy": true, "source": 4, "target": 5},
	{"cosy": true, "source": 4, "target": 7},
	{"cosy": true, "source": 5, "target": 8},
	{"cosy": true, "source": 6, "target": 9},
	{"cosy": true, "hmbc": true, "source": 6, "target": 10},
	{"hmbc": true, "source": 6, "target": 7},
	{"hmbc": true, "source": 9, "target": 10},
];

    // Set initial positions of nodes and links
    nodes.forEach(node => {
        node.x = xScale(node.x)+100;
        node.y = yScale(node.y)+50;
    });

    // Filter links that have the attribute cosy as true
    const cosyLinks = links.filter(link => link.cosy);

    // Create the links
    const link = svg.selectAll(".link")
      .data(cosyLinks)
      .enter().append("line")
      .attr("class", "link")
      .attr("stroke", "black")
      .attr("x1", d => nodes[d.source-1].x)
      .attr("y1", d => nodes[d.source-1].y)
      .attr("x2", d => nodes[d.target-1].x)
      .attr("y2", d => nodes[d.target-1].y)
      .attr("stroke", blue) // Set the stroke color for links to blue
      .attr("stroke-width", 8); // Set the stroke width to 2 pixels

    // Create the nodes
    const node = svg.selectAll(".node")
      .data(nodes)
      .enter().append("g")
      .attr("class", "node")
      .attr("transform", d => `translate(${d.x},${d.y})`)
      .call(d3.drag()
        .on("start", dragstarted)
        .on("drag", dragged)
        .on("end", dragended));

    // Add circles to represent nodes
    node.append("circle")
      .attr("r", 22)
      .attr("fill", d => colorScale(d.numProtons)) // Set fill color based on numProtons
      .on("mouseover", (event, d) => handleMouseOver(event, d)) // Call function when mouseover
      .on("mouseout", (event, d) => handleMouseOut(event, d));  // Call function when mouseout

    // Append text
    node.append("text")
        .attr("class", "node-text")
        .text(d => d.id) // Display the id
        .attr("dy", -8) // Center the text vertically
        .attr("font-size", "12px") // Set font size to 16 pixels
        .attr("text-anchor", "middle"); // Center the text horizontally

    // // Append ppm text
    node.append("text")
        .attr("class", "node-text")
        .text(d => d.ppm.toFixed(2)) // Display the id
        .attr("dy", +8) // Center the text vertically
        .attr("font-size", "12px") // Set font size to 16 pixels
        .attr("text-anchor", "middle"); // Center the text horizontally

    // Tooltip for node hover
    const tooltip = d3.select("#tooltip");

    let hmbcLinks = []; // Track hmbc links separately

    // Drag handlers
    function dragstarted(event, d) {
      // Remove hmbc links
      hmbcLinks.forEach(link => link.remove());
      hmbcLinks = []; // Clear the hmbc links array
      d3.select(this).raise().classed("active", true);
    }

    function dragged(event, d) {
      d.x = event.x;
      d.y = event.y;
      d3.select(this).attr("transform", `translate(${d.x},${d.y})`);
      link.filter(l => l.source === d.id).attr("x1", d.x).attr("y1", d.y);
      link.filter(l => l.target === d.id).attr("x2", d.x).attr("y2", d.y);
    }

    function dragended(event, d) {
      d3.select(this).classed("active", false);
    }

    // Function to find nearest neighbors of a node with a specific attribute
    function findNearestNeighbors(nodeId, attribute) {
    const neighbors = [];

    // Iterate through the links
    links.forEach(link => {
        if (link[attribute] && (link.source === nodeId || link.target === nodeId)) {
        neighbors.push(link.source === nodeId ? link.target : link.source);
        }
    });

    return neighbors;
    }

    // Function to handle mouseover event
    function handleMouseOver(event, d) {
        // Display tooltip
        if (event) {

            // generate the html sub string for d.H1 ppm which is an array

            // When numProtons is 0
            if (d.numProtons == 0) {
                var htmlstr =  `C${d.id} ${generateHTMLnumProtonsString(d.numProtons)}: <sup>13</sup>C = ${d.ppm.toFixed(2)} ppm`;
            } else if (d.H1_ppm.length == 1) {
                // Expect d.H1 to be an array of length 1
                var htmlstr =  `C${d.id} ${generateHTMLnumProtonsString(d.numProtons)}: <sup>13</sup>C = ${d.ppm.toFixed(2)} ppm, <sup>1</sup>H = ${d.H1_ppm[0].toFixed(2)} ppm`;
                    htmlstr = htmlstr + `<br>J's : ${d.jCouplingClass[0]} : ${d.jCouplingVals[0]} Hz`;
            } else {
                // Expect d.H1 to be an array of length 2
                var htmlstr =  `C${d.id} ${generateHTMLnumProtonsString(d.numProtons)}: <sup>13</sup>C = ${d.ppm.toFixed(2)} ppm, <sup>1</sup>H = ${d.H1_ppm[0].toFixed(2)} & ${d.H1_ppm[1].toFixed(2)} ppm`;
                // add the J coupling values
                htmlstr = htmlstr + `<br>J's : ${d.jCouplingClass[0]} : ${d.jCouplingVals[0]} Hz, ${d.jCouplingClass[1]} : ${d.jCouplingVals[1]} Hz`;
            }



            // var htmlstr =  `C${d.id} ${generateHTMLnumProtonsString(d.numProtons)}: <sup>13</sup>C = ${d.ppm.toFixed(2)} ppm, <sup>1</sup>H = xxx ppm`;
            tooltip.transition()
                .duration(200)
                .style("opacity", 0.9);
            tooltip.html(htmlstr)    
                .style("left", (200) + "px")
                .style("top", (-99999) + "px")
                .style("display", "inline-block");

            var tooltipDiv = d3.select('#tooltip');

            // Get the corresponding DOM element
            var tooltipNode = tooltipDiv.node();

            var pageWidth = document.documentElement.clientWidth;

            // Get the dimensions of the div element
            var tooltipWidth = tooltipNode.clientWidth;
            var tooltipHeight = tooltipNode.clientHeight;
            var tooltipX = (pageWidth - tooltipWidth) / 2;

            tooltip.html(htmlstr) 
                .style("left", (tooltipX) + "px")
                .style("top", (30) + "px")
                .style("display", "inline-block");
        }
        // Increase the radius
        d3.select(event.target)
            .transition()
            .duration(100)
            .attr("r", 26);

        // Define the attribute to find nearest neighbors
        const attribute = "hmbc";
        const attribute2 = "noesy";
        
        // Call the function to find nearest neighbors
        const nearestNeighborIDs = findNearestNeighbors(d.id, attribute);
        const nearestNeighborIDs2 = findNearestNeighbors(d.id, attribute2);
       
        // Add hmbc links to nearest neighbors
        nearestNeighborIDs.forEach(neighborID => {
            const neighborNode = nodes.find(node => node.id === neighborID);
            if (neighborNode) {
                const link = svg.insert("line", ".node")
                    .attr("class", "link")
                    .attr("x1", d.x)
                    .attr("y1", d.y)
                    .attr("x2", neighborNode.x)
                    .attr("y2", neighborNode.y)
                    .attr("stroke", grey)
                    .attr("stroke-width", 7); // Set the stroke width to 2 pixels
                hmbcLinks.push(link); // Track the hmbc links
            }
        });

    nearestNeighborIDs2.forEach(neighborID => {
        const neighborNode = nodes.find(node => node.id === neighborID);
            if (neighborNode) {
                // Calculate control points for the curve
                // const control1X = d.x + (neighborNode.x - d.x) / 3;
                // const control1Y = d.y;
                // const control2X = neighborNode.x - (neighborNode.x - d.x) / 3;
                // const control2Y = neighborNode.y;

                const path = d3.path();
                path.moveTo(d.x, d.y);
                path.quadraticCurveTo(0, 0, neighborNode.x, neighborNode.y);

                const link = svg.insert("path", ".node")
                    .attr("class", "link")
                    .attr("fill", "none")
                    .attr("stroke", grey)
                    .attr("stroke-width", 7) // Set the stroke width to 7 pixels
                    .attr("stroke-dasharray", "5,5") // Set the stroke-dasharray for dashed lines
                    .attr("d", path); // Generate the curved link path using cubic Bezier curve
                hmbcLinks.push(link); // Track the hmbc links
            }
    });
}

    // Function to handle mouseout event
    function handleMouseOut(event, d) {
        // Hide the tooltip
        tooltip.transition()
                .duration(100)
                .style("opacity", 0);
        // Revert the radius
        d3.select(event.target)
            .transition()
            .duration(100)
            .attr("r", 22);

        // Remove hmbc links
        hmbcLinks.forEach(link => link.remove());
        hmbcLinks = []; // Clear the hmbc links array
    }

    function generateHTMLnumProtonsString(index) {
        switch (index) {
            case 0:
            return "-C-";
            case 1:
            return "-CH";
            case 2:
            return "-CH<sub>2</sub>";
            case 3:
            return "-CH<sub>3</sub>";
            default:
            return "<p>Invalid index</p>";
        }
    }
  </script>
</body>
</html>